import numpy as np
#import matplotlib.pyplot as plt

def density_function(x,y,z,alpha=1.):
    # alpha is a density proportionality constant
    r = np.sqrt(x**2. + y**2. + z**2.)
    if r > rmax:
        return 0.
    else:
        return alpha*r**(-2.)

Nx = 500
Ny = 500
Nz = 50

rmax = 1.

xmin = -1.
xmax = 1.
ymin = -1.
ymax = 1.
zmin = -1.
zmax = 1.

dx = xmax - xmin
dy = ymax - ymin
dz = zmax - zmin

rho = np.zeros(shape=(Nx,Ny,Nz))

x = np.linspace(xmin,xmax,Nx)
y = np.linspace(ymin,ymax,Ny)
z = np.linspace(zmin,zmax,Nz)

#rho_mid = np.zeros(Nx)
with open('cloud.dat','w') as f:
    for i in range(0,Nx):
        for j in range(0,Ny):
            for k in range(0,Nz):
                rho[i][j][k] = density_function(x[i],y[j],z[k])
                #if j == int(Ny/2) and k == int(Nz/2):
                #    rho_mid[i] = rho[i][j][k]
                f.write(("%15.7E "*4+"\n") % (x[i],y[j],z[k],rho[i][j][k]))


#plt.plot(x,rho_mid)
#plt.show()
